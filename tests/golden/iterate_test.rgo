str: @/str
int: @/int
printf: @/printf
exit: @/exit
list: ((int, list), ())
nil: (next:(int, list), end:()){
    end()
}
cons: (head: int, tail: list, next:(int, list), end:()){
    next(head, tail)
}
iterate_inner: (iterate: ((int, ()), list, ()), handler:(int, ()), end:(), head: int, tail: list){
    x: iterate(handler, tail, end)
    handler(head, x)
}
iterate: (handler:(int, ()), arr: list, end:()){
    arr(iterate_inner(iterate, handler, end), end)
}
handler: (n: int, ok:()){
    printf("%d, ", n, ok)
}
end: (){
    printf("end\n", exit(0))
}
mylist: cons(1, cons(2, cons(3, cons(4, nil))))
iterate(handler, mylist, end)
