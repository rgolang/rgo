
str: @/str
int: @/int
printf: @/printf
exit: @/exit

list: ((int, list), ())
nil: (next:(int, list), end: ()){
    end()
}
cons: (head:int, tail:list, next:(int, list), end: ()){
    next(head, tail)
}
iterate: (handler: (int, ()), arr: list, end: ()){
    iterate_inner: (head:int, tail:list){
        next_iterate: iterate(handler, tail, end)
        handler(head, next_iterate)
    }
    arr(iterate_inner, end)
}
mylist: cons(1, cons(2, cons(3, cons(4, nil))))
handler: (n: int, ok: ()){
    printf("%d, ", n, ok)
}
end: {printf("end\n", exit(0))}
iterate(handler, mylist, end)
